Metadata-Version: 2.4
Name: docx-comments-roundtrip
Version: 0.1.0
Summary: Lossless DOCX <-> Markdown conversion preserving Word comment threads
Author: docx-comments-roundtrip maintainers
License: MIT
Project-URL: Homepage, https://github.com/pascalkueng/docx-comments-roundtrip
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3 :: Only
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10
Description-Content-Type: text/markdown

# docx-comments-roundtrip

Lossless `.docx <-> .md` conversion focused on preserving Word comment anchors, threads, and states.

## Scope

This tool is intentionally narrow and robust:

- Preserves comment anchors through roundtrip.
- Reconstructs native Word reply threads (`parentId` / `paraIdParent`) on `md -> docx`.
- Preserves comment state (`active` / `resolved`) for roots and replies.
- Uses readable markdown markers and cards:
  - Prose markers: `==///C<ID>.START///== ... ==///C<ID>.END///==` (or unwrapped `///...///`).
  - Comment cards: blockquote callouts with `CARD_META` HTML comments.
- Validates malformed marker edits with line-specific diagnostics before conversion.

It is not a general-purpose Word layout converter; comment fidelity is the primary goal.

## Installation

### Prerequisites

- Python 3.10+
- Pandoc on `PATH`

Install Pandoc:

- macOS: `brew install pandoc`
- Ubuntu/Debian: `sudo apt-get install pandoc`
- Windows (PowerShell): `choco install pandoc -y`

### Recommended: `pipx`

```bash
pipx install docx-comments-roundtrip
```

Upgrade later:

```bash
pipx upgrade docx-comments-roundtrip
```

### Alternative: `pip`

```bash
python -m pip install docx-comments-roundtrip
```

### Local development install

From this repository:

```bash
python -m pip install -e .
```

## CLI Usage

Installed console commands:

- `dmt`
- `docx-comments`
- `docx2md`, `d2m`
- `md2docx`, `m2d`

### Auto-detect mode

```bash
dmt draft.docx
dmt draft.md
```

Equivalent legacy command:

```bash
docx-comments draft.docx
docx-comments draft.md
```

### Explicit conversion

DOCX -> Markdown:

```bash
docx2md draft.docx -o draft.md
d2m draft.docx -o draft.md
dmt docx2md draft.docx -o draft.md
```

Markdown -> DOCX:

```bash
md2docx draft.md -o draft.docx
m2d draft.md -o draft.docx
dmt md2docx draft.md -o draft.docx
```

Reference document shortcut (`-r/--ref`):

```bash
md2docx draft.md --ref original.docx -o final.docx
m2d draft.md -r original.docx -o final.docx
```

`--ref` maps to pandoc `--reference-doc`.

### Pass-through pandoc args

Unknown flags are forwarded to pandoc:

```bash
docx2md draft.docx -o draft.md --extract-media=media
dmt md2docx draft.md --reference-doc=template.docx
```

## Help Screens

```bash
dmt --help
docx2md --help
md2docx --help
```

## Testing

Run everything:

```bash
make test
```

Run roundtrip-focused tests only:

```bash
make test-roundtrip
```

`make test` also writes manual artifacts:

- `artifacts/out_test.md`
- `artifacts/out_test.docx`

When a test fails, inspect the emitted `failure_bundle` path from unittest output.
